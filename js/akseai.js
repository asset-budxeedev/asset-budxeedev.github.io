const API_URL="http://localhost:4000/api/chat";document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("chatContainer"),t=document.getElementById("messageInput");if(!e||!t)return void console.error("Elemen DOM yang diperlukan tidak ditemukan.");window.sendMessage=async function(){const n=t.value.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");if(!n)return void alert("Pesan tidak boleh kosong!");const a=document.createElement("div");a.className="message",a.textContent=n,e.appendChild(a),e.scrollTop=e.scrollHeight,t.value="";const s=function(){const t=document.createElement("div");return t.className="typing-indicator",t.innerHTML="<span></span><span></span><span></span>",t.textContent="Akse sedang mengetik...",e.appendChild(t),e.scrollTop=e.scrollHeight,t}();document.getElementById("titleAi").style.display="none";document.getElementById("subtitleAi").style.display="block";try{const t=await fetch(API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n})});if(!t.ok)throw new Error("Gagal mendapatkan respons dari server.");const a=await t.json(),o=document.createElement("div");o.className="response",o.innerHTML=marked.parse(a.content||"Maaf, saya tidak dapat memproses permintaan Anda saat ini."),e.appendChild(o);o.querySelectorAll("pre code").forEach(e=>{hljs.highlightBlock(e)})}catch(t){console.error("Error saat mengirim pesan:",t);const n=document.createElement("div");n.className="response",n.textContent="Terjadi kesalahan, silakan coba lagi.",e.appendChild(n)}finally{!function(e){e&&e.remove()}(s),e.scrollTop=e.scrollHeight}},t.addEventListener("keydown",e=>{"Enter"===e.key&&sendMessage()});const n=document.getElementById("navbarOpen"),a=document.getElementById("navLinks");n.addEventListener("click",()=>{a.classList.toggle("active")})});
