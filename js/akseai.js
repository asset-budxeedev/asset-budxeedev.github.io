const API_URL="https://akseai.up.railway.app/api/chat";document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("chatContainer"),t=document.getElementById("messageInput");if(!e||!t)return void console.error("Elemen DOM yang diperlukan tidak ditemukan.");const n=[];window.sendMessage=async function(){const a=t.value.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");if(!a)return void alert("Pesan tidak boleh kosong!");const s=document.createElement("div");s.className="message",s.textContent=a,e.appendChild(s),e.scrollTop=e.scrollHeight,t.value="",n.push({role:"user",content:a});const o=function(){const t=document.createElement("div");return t.className="typing-indicator",t.innerHTML="<span></span><span></span><span></span>",t.textContent="Akse sedang mengetik...",e.appendChild(t),e.scrollTop=e.scrollHeight,t}();document.getElementById("titleAi").style.display="none";document.getElementById("subtitleAi").style.display="block";try{const t=await fetch(API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:"user_default",message:a})});if(!t.ok)throw new Error("Gagal mendapatkan respons dari server.");const s=(await t.json()).response,l=document.createElement("div");l.className="response",l.innerHTML=marked.parse(s||"Maaf, saya tidak dapat memproses permintaan Anda saat ini."),e.appendChild(l);l.querySelectorAll("pre code").forEach(e=>{hljs.highlightBlock(e)}),n.push({role:"assistant",content:s})}catch(t){console.error("Error saat mengirim pesan:",t);const n=document.createElement("div");n.className="response",n.textContent="Terjadi kesalahan, silakan coba lagi.",e.appendChild(n)}finally{!function(e){e&&e.remove()}(o),e.scrollTop=e.scrollHeight}},t.addEventListener("keydown",e=>{"Enter"===e.key&&sendMessage()});const a=document.getElementById("navbarOpen"),s=document.getElementById("navLinks");a.addEventListener("click",()=>{s.classList.toggle("active")})});
