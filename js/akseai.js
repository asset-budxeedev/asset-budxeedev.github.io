const API_URL="https://akseai.up.railway.app/api/chat";document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("chatContainer"),n=document.getElementById("messageInput");if(!e||!n)return void console.error("Elemen DOM yang diperlukan tidak ditemukan.");const t=[];window.sendMessage=async function(){const a=n.value.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");if(!a)return void alert("Pesan tidak boleh kosong!");const s=document.createElement("div");s.className="message",s.textContent=a,e.appendChild(s),e.scrollTop=e.scrollHeight,n.value="",t.push({role:"user",content:a});const o=function(){const n=document.createElement("div");return n.className="typing-indicator",n.innerHTML="<span></span><span></span><span></span>",n.textContent="Akse sedang mengetik...",e.appendChild(n),e.scrollTop=e.scrollHeight,n}();document.getElementById("titleAi").style.display="none";document.getElementById("subtitleAi").style.display="block";try{const n=await fetch(API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:"unique_user_id",message:a})});if(!n.ok)throw new Error("Gagal mendapatkan respons dari server.");const s=(await n.json()).response,r=document.createElement("div");r.className="response",r.innerHTML=marked.parse(s||"Maaf, saya tidak dapat memproses permintaan Anda saat ini."),e.appendChild(r);r.querySelectorAll("pre code").forEach(e=>{hljs.highlightBlock(e)}),t.push({role:"assistant",content:s})}catch(n){console.error("Error saat mengirim pesan:",n);const t=document.createElement("div");t.className="response",t.textContent="Terjadi kesalahan, silakan coba lagi.",e.appendChild(t)}finally{!function(e){e&&e.remove()}(o),e.scrollTop=e.scrollHeight}},n.addEventListener("keydown",e=>{"Enter"===e.key&&sendMessage()});const a=document.getElementById("navbarOpen"),s=document.getElementById("navLinks");a.addEventListener("click",()=>{s.classList.toggle("active")})});
